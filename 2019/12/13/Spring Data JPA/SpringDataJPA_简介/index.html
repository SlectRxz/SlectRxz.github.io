<!DOCTYPE html><html data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>JPA简介 | 荣先森</title><meta name="description" content="JPA简介"><meta name="keywords" content="Java框架"><meta name="author" content="Rong"><meta name="copyright" content="Rong"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/1.jpg"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="JPA简介"><meta name="twitter:description" content="JPA简介"><meta name="twitter:image" content="https://s2.ax1x.com/2019/12/20/QXe9PS.jpg"><meta property="og:type" content="article"><meta property="og:title" content="JPA简介"><meta property="og:url" content="http://SlectRxz.github.io/2019/12/13/Spring Data JPA/SpringDataJPA_简介/"><meta property="og:site_name" content="荣先森"><meta property="og:description" content="JPA简介"><meta property="og:image" content="https://s2.ax1x.com/2019/12/20/QXe9PS.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="http://SlectRxz.github.io/2019/12/13/Spring Data JPA/SpringDataJPA_简介/"><link rel="prev" title="Spring Data JPA入门案例" href="http://SlectRxz.github.io/2019/12/14/Spring Data JPA/SpringDataJPA_入门案例/"><link rel="next" title="java基础知识复习" href="http://SlectRxz.github.io/2019/11/04/java基础/基础知识的复习/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://blog.csdn.net/qq_36639232","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: true,
  fancybox: true,
  Snackbar: {"bookmark":{"title":"Snackbar.bookmark.title","message_prev":"Press","message_next":"to bookmark this page"},"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Light Mode Activated Manually","night_to_day":"Dark Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script></head><body><canvas class="fireworks"></canvas><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">荣先森</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">44</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">11</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">11</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">Catalog</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ORM的概述"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">ORM的概述</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#JAP的概述"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">JAP的概述</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#JAP与hibernate的关系"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text">JAP与hibernate的关系</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#JPA入门案例的搭建"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">JPA入门案例的搭建</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#JPA中的复杂查询"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">JPA中的复杂查询</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#maven坐标"><span class="toc_mobile_items-number">4.1.</span> <span class="toc_mobile_items-text">maven坐标</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ORM的概述"><span class="toc-number">1.</span> <span class="toc-text">ORM的概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JAP的概述"><span class="toc-number">2.</span> <span class="toc-text">JAP的概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JAP与hibernate的关系"><span class="toc-number">2.1.</span> <span class="toc-text">JAP与hibernate的关系</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JPA入门案例的搭建"><span class="toc-number">3.</span> <span class="toc-text">JPA入门案例的搭建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JPA中的复杂查询"><span class="toc-number">4.</span> <span class="toc-text">JPA中的复杂查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#maven坐标"><span class="toc-number">4.1.</span> <span class="toc-text">maven坐标</span></a></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://s2.ax1x.com/2019/12/20/QXe9PS.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">JPA简介</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> Created 2019-12-13<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> Updated 2019-12-20</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Spring-Data-JPA/">Spring Data JPA</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>Post View:</span><span id="busuanzi_value_page_pv"></span></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><p>对SpringDataJPA的入门介绍，包括ORM的概述以及对JPA和hibernate的简介，搭建JPA的入门案例、增删查改、复杂查询等操作。<br><a id="more"></a></p>
<h2 id="ORM的概述"><a href="#ORM的概述" class="headerlink" title="ORM的概述"></a>ORM的概述</h2><blockquote>
<p>ORM（Object-Relational Mapping）表示对象关系映射。基于面向对象的思想，将对象与关系型数据库进行映射。简单而言，ORM就是建立实体类和数据库表之间的关系，从而达到操作实体类就相当于操作数据库表的目的。</p>
</blockquote>
<p>主要目的：操作实体类就相当于操作数据库表</p>
<ul>
<li><p>建立两个映射关系：</p>
<ul>
<li><p>实体类和表的映射关系</p>
</li>
<li><p>实体类中属性和表中字段的映射关系</p>
</li>
</ul>
</li>
</ul>
<p>  不再重点关注：sql语句</p>
<h2 id="JAP的概述"><a href="#JAP的概述" class="headerlink" title="JAP的概述"></a>JAP的概述</h2><p>常见的ORM框架有Mybatis(半自动)，Hibernate（全自动），JPA。</p>
<p>JAP（Java Persistence API），即Java持久化API，由SUN公司退出的一套基于ORM的规范，内部由<font color="red">一系列的接口和抽象类组成</font>。</p>
<p><strong>JPA的优势：</strong></p>
<p><strong>1.</strong> <strong>标准化</strong></p>
<p>  JPA 是 JCP 组织发布的 Java EE 标准之一，因此任何声称符合 JPA 标准的框架都遵循同样的架构，提供相同的访问API，这保证了基于JPA开发的企业应用能够经过少量的修改就能够在不同的JPA框架下运行。</p>
<p> <strong>2.</strong> <strong>容器级特性的支持</strong></p>
<p>  JPA框架中支持大数据集、事务、并发等容器级事务，这使得 JPA 超越了简单持久化框架的局限，在企业应用发挥更大的作用。</p>
<p><strong>3.</strong> <strong>简单方便</strong></p>
<p>  JPA的主要目标之一就是提供更加简单的编程模型：在JPA框架下创建实体和创建Java 类一样简单，没有任何的约束和限制，只需要使用 javax.persistence.Entity进行注释，JPA的框架和接口也都非常简单，没有太多特别的规则和设计模式的要求，开发者可以很容易的掌握。JPA基于非侵入式原则设计，因此可以很容易的和其它框架或者容器集成</p>
<p> <strong>4.</strong> <strong>查询能力</strong></p>
<p>  JPA的查询语言是面向对象而非面向数据库的，它以面向对象的自然语法构造查询语句，可以看成是Hibernate HQL的等价物。JPA定义了独特的JPQL（Java Persistence Query Language），JPQL是EJB QL的一种扩展，它是针对实体的一种查询语言，操作对象是实体，而不是关系数据库的表，而且能够支持批量更新和修改、JOIN、GROUP BY、HAVING 等通常只有 SQL 才能够提供的高级查询特性，甚至还能够支持子查询。</p>
<p> <strong>5.</strong> <strong>高级特性</strong></p>
<p> JPA 中能够支持面向对象的高级特性，如类之间的继承、多态和类之间的复杂关系，这样的支持能够让开发者最大限度的使用面向对象的模型设计企业应用，而不需要自行处理这些特性在关系数据库的持久化。</p>
<h3 id="JAP与hibernate的关系"><a href="#JAP与hibernate的关系" class="headerlink" title="JAP与hibernate的关系"></a>JAP与hibernate的关系</h3><blockquote>
<p>hibernate是一个开放源代码的对象关系映射框架，它对JDBC进行了非常轻量级的对象封装，它将POJO与数据库表建立映射关系，是一个全自动的orm框架，hibernate可以自动生成SQL语句，自动执行，使得Java程序员可以随心所欲的使用对象编程思维来操纵数据库。</p>
</blockquote>
<p>总之，hibernate的目的在于程序员忽略SQL语句，以执行对象的形式达到操作数据库表。</p>
<p><a href="\img\imgs\springdatajpa\简介01.png" data-fancybox="group" data-caption="JPA与hibernate的关系" class="fancybox"><img src="\img\imgs\springdatajpa\简介01.png" alt="JPA与hibernate的关系" title="JPA与hibernate的关系" class="mediumZoom"></a></p>
<p>JPA和Hibernate的关系就像JDBC和JDBC驱动的关系，JPA是规范，Hibernate除了作为ORM框架之外，它也是一种JPA实现。JPA怎么取代Hibernate呢？JDBC规范可以驱动底层数据库吗？答案是否定的，<font color="red">也就是说，如果使用JPA规范进行数据库操作，底层需要hibernate作为其实现类完成数据持久化工作。（可以类比JDBC规范和各个数据库厂商来具体实现这两者的关系）</font></p>
<h2 id="JPA入门案例的搭建"><a href="#JPA入门案例的搭建" class="headerlink" title="JPA入门案例的搭建"></a>JPA入门案例的搭建</h2><p>基于工程：Maven工程</p>
<p>坐标：文章结尾处</p>
<p>数据库表：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">/*创建客户表*/</span><br><span class="line">   CREATE TABLE cst_customer (</span><br><span class="line">     cust_id bigint(32) NOT NULL AUTO_INCREMENT COMMENT &apos;客户编号(主键)&apos;,</span><br><span class="line">     cust_name varchar(32) NOT NULL COMMENT &apos;客户名称(公司名称)&apos;,</span><br><span class="line">     cust_source varchar(32) DEFAULT NULL COMMENT &apos;客户信息来源&apos;,</span><br><span class="line">     cust_industry varchar(32) DEFAULT NULL COMMENT &apos;客户所属行业&apos;,</span><br><span class="line">     cust_level varchar(32) DEFAULT NULL COMMENT &apos;客户级别&apos;,</span><br><span class="line">     cust_address varchar(128) DEFAULT NULL COMMENT &apos;客户联系地址&apos;,</span><br><span class="line">     cust_phone varchar(64) DEFAULT NULL COMMENT &apos;客户联系电话&apos;,</span><br><span class="line">     PRIMARY KEY (`cust_id`)</span><br><span class="line">   ) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;</span><br></pre></td></tr></table></figure></div>
<p>实体类POJO：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Customer</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">private</span> Long custId;</span><br><span class="line">	<span class="keyword">private</span> String custName;</span><br><span class="line">	<span class="keyword">private</span> String custSource;</span><br><span class="line">	<span class="keyword">private</span> String custIndustry;</span><br><span class="line">	<span class="keyword">private</span> String custLevel;</span><br><span class="line">	<span class="keyword">private</span> String custAddress;</span><br><span class="line">	<span class="keyword">private</span> String custPhone;</span><br><span class="line">	...get/set方法（略）</span><br></pre></td></tr></table></figure></div>
<p>项目目录：</p>
<p><a href="\img\imgs\springdatajpa\简介02.png" data-fancybox="group" data-caption="项目目录" class="fancybox"><img src="\img\imgs\springdatajpa\简介02.png" alt="项目目录" style="zoom:67%;" title="项目目录" class="mediumZoom"></a></p>
<p><strong>案例：对数据库中的客户表（增删查改）</strong></p>
<ol>
<li><p>创建maven工程，导入坐标</p>
</li>
<li><p>配置JPA的核心配置文件</p>
<ul>
<li>位置：配置到类路径下的一个叫做META-INF的文件夹下</li>
<li>命名：persistent.xml</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">xml</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">persistence</span> <span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/persistence"</span> <span class="attr">version</span>=<span class="string">"2.0"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    持久化单元</span></span><br><span class="line"><span class="comment">        name：持久化单元名称  可以自定义</span></span><br><span class="line"><span class="comment">        transaction-type：事务管理的方式</span></span><br><span class="line"><span class="comment">                        JTA:分布式事务管理（针对：不同的表分布在不同的数据库中）</span></span><br><span class="line"><span class="comment">                        RESOURCE_LOCAL：本地事务管理</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">persistence-unit</span> <span class="attr">name</span>=<span class="string">"myJpa"</span> <span class="attr">transaction-type</span>=<span class="string">"RESOURCE_LOCAL"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--1.jpa的实现方式--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">provider</span>&gt;</span>org.hibernate.jpa.HibernatePersistenceProvider<span class="tag">&lt;/<span class="name">provider</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 2.配置数据库信息</span></span><br><span class="line"><span class="comment">                  用户名，javax.persistence.jdbc.user</span></span><br><span class="line"><span class="comment">                  密码，  javax.persistence.jdbc.password</span></span><br><span class="line"><span class="comment">                  驱动，  javax.persistence.jdbc.driver</span></span><br><span class="line"><span class="comment">                  数据库地址   javax.persistence.jdbc.url</span></span><br><span class="line"><span class="comment">              --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"javax.persistence.jdbc.user"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"javax.persistence.jdbc.password"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"javax.persistence.jdbc.driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"javax.persistence.jdbc.url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf-8"</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--3.配置jpa实现（hibernate）的配置信息</span></span><br><span class="line"><span class="comment">                显示sql：hibernate.show_sql   false/true</span></span><br><span class="line"><span class="comment">                自动创建数据库表：hibernate.hbm2ddl.auto</span></span><br><span class="line"><span class="comment">                        create：程序运行时创建数据库表（如果表已存在，先删除再创建）</span></span><br><span class="line"><span class="comment">                        update：程序运行时创建（如果有表，不会创建表）</span></span><br><span class="line"><span class="comment">                        none：不会创建表</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.show_sql"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.hbm2ddl.auto"</span> <span class="attr">value</span>=<span class="string">"update"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">persistence-unit</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">persistence</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
</li>
</ol>
<ol start="3">
<li><p>配置实体类与数据库表的映射关系</p>
<p>我们需要配置：</p>
<p>   1).<strong>实体类与表的映射关系</strong>（此pojo与数据库中的那一张表关系映射）</p>
<p>​          @ Entity<br>​          @ Table(name=”cst_customer”)name表示数据库中表的名称</p>
<p>   2).<strong>实体类中属性与表中字段的映射关系</strong></p>
<p>​       @ Id声明主键的设置<br>​       @ GeneratedValue配置主键是生成策略（自动增长）<br>​           strategy=<br>​                     GenerationType.IDENTITY:自增  Mysql（底层数据库支持的自增长方式对id自增）<br>​                     GenerationType.SEQUENCE：序列 Oracle（底层数据库必须支持序列）<br>​                     GenerationType.TABLE：jpa提供的一种机制，通过一张数据库表的形式帮助我们完成自增<br>​                     GenerationType.AUTO:有程序自动的帮助我们选择主键生成策略<br>​       @ Column(name = “cust_id”)数据库中表中字段的名字</p>
</li>
</ol>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> ctgu.pojo;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.*;</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name=<span class="string">"cst_customer"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Customer</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @ Id声明主键的设置</span></span><br><span class="line"><span class="comment">     * @ GeneratedValue配置主键是生成策略（自动增长）</span></span><br><span class="line"><span class="comment">     *              GenerationType.IDENTITY</span></span><br><span class="line"><span class="comment">     * @ Column(name = "cust_id")数据库中表中字段的名字</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"cust_id"</span>)</span><br><span class="line">    <span class="keyword">private</span> Long custId;</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"cust_name"</span>)</span><br><span class="line">    <span class="keyword">private</span> String custName;</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"cust_source"</span>)</span><br><span class="line">    <span class="keyword">private</span> String custSource;</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"cust_industry"</span>)</span><br><span class="line">    <span class="keyword">private</span> String custIndustry;</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"cust_level"</span>)</span><br><span class="line">    <span class="keyword">private</span> String custLevel;</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"cust_address"</span>)</span><br><span class="line">    <span class="keyword">private</span> String custAddress;</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"cust_phone"</span>)</span><br><span class="line">    <span class="keyword">private</span> String custPhone;</span><br><span class="line">	...set/get方法(略)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<ol start="4">
<li><p>测试</p>
<p> 操作：向数据库中添加一个用户。</p>
<p> Jpa的操作步骤： </p>
<ul>
<li>1.加载配置文件创建工厂（实体管理器工厂）对象</li>
<li>2.通过实体管理类工厂获取实体管理器</li>
<li>3.获取事务对象，开启事务（重要！）</li>
<li>4.完成增删改查</li>
<li>5.提交事务（如果抛出异常，回滚事务）</li>
<li><p>6.释放资源</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveCustomer</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="comment">// 1.加载配置文件创建工厂（实体管理器工厂）对象   输入参数：持久化单元名称，在下xml中</span></span><br><span class="line">       EntityManagerFactory factory = Persistence.createEntityManagerFactory(<span class="string">"myJpa"</span>);</span><br><span class="line">       <span class="comment">//2.通过实体管理类工厂获取实体管理器</span></span><br><span class="line">       EntityManager manager = factory.createEntityManager();</span><br><span class="line">       <span class="comment">//3.获取事务对象，开启事务（重要！）</span></span><br><span class="line">       EntityTransaction transaction = manager.getTransaction();</span><br><span class="line">        <span class="comment">//开启事务</span></span><br><span class="line">       transaction.begin();</span><br><span class="line">       <span class="comment">//4.创建对象，完成保存操作</span></span><br><span class="line">       Customer customer = <span class="keyword">new</span> Customer();</span><br><span class="line">       customer.setCustName(<span class="string">"三峡大学"</span>);</span><br><span class="line">       customer.setCustIndustry(<span class="string">"大学"</span>);</span><br><span class="line">       manager.persist(customer);</span><br><span class="line">   <span class="comment">// 5.提交事务</span></span><br><span class="line">       transaction.commit();</span><br><span class="line">       <span class="comment">//6.释放资源</span></span><br><span class="line">       manager.close();</span><br><span class="line">       <span class="comment">//factory.close();</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></div>
</li>
</ul>
</li>
</ol>
<pre><code>我们发现上述步骤中获取实体管理器是可以简化成工具类的。

JpaUtils：

 * 解决实体管理器工厂的浪费资源和耗时的问题
 *          通过静态代码块的形式，当程序第一次访问此类时，创建一个公共管理器工厂对象
 * 第一次访问getEntityManager（）方法时，首先会执行静态代码块创建一个factory对象，再创建一个EntityManager对象；
 * 第二次访问时，由于静态代码块只会在创建时执行一次，直接返回EntityManager对象



<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> ctgu.utils;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.EntityManager;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.EntityManagerFactory;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JpaUtils</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> EntityManagerFactory factory;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">         factory = Persistence.createEntityManagerFactory(<span class="string">"myJpa"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取EntityManager对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> EntityManager <span class="title">getEntityManager</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> factory.createEntityManager();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>


## JPA中的API介绍

上述已经实现了一个基本的保存用户的案例，下面对于JPA中的一些API进行简单的介绍：

1. Persistence

   <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">EntityManagerFactory factory = Persistence.createEntityManagerFactory(<span class="string">"myJpa"</span>);</span><br></pre></td></tr></table></figure></div>


   主要是用于获取EntityManageFactory对象，通过调用该类的静态方法，形参为配置文件中持久化单元的名称。

2. EntityManageFactory

   <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">EntityManager manager = factory.createEntityManager();</span><br></pre></td></tr></table></figure></div>


   EntityManageFactory接口主要用于创建EntityManage实例。

3. EntityManage

   <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">manager.persist(customer);<span class="comment">//增</span></span><br><span class="line">manager.find(Customer.class, <span class="number">1L</span>);<span class="comment">//查（立即加载）</span></span><br><span class="line">manager.getReference(Customer.class, <span class="number">1L</span>);<span class="comment">//查（延迟加载）</span></span><br><span class="line">manager.remove(customer);<span class="comment">//删</span></span><br><span class="line">manager.merge(customer);<span class="comment">//改</span></span><br></pre></td></tr></table></figure></div>


   EntityManager是完成持久化操作的核心对象。实体类作为普通 java对象，只有在调用 EntityManager将其持久化后才会变成持久化对象。EntityManager对象在一组实体类与底层数据源之间进行 O/R 映射的管理。它可以用来管理和更新 Entity Bean, 根椐主键查找 Entity Bean, 还可以通过JPQL语句查询实体。

4. EntityTransaction

   EntityTransaction是完成事务操作的核心对象，对于EntityTransaction在我们的java代码中承接的功能比较简单

   begin：开启事务
   commit：提交事务
   rollback：回滚事务

## JPA中的增删查改

上述我们已经介绍了向数据库中添加数据，下面介绍JPA中的删除，修改，查询：
</code></pre><p>  查询：<br>根据id查修客户<br>find()方法：</p>
<ul>
<li><p>参数一：class，查询数据的结果需要包装的实体类型的字节码</p>
</li>
<li><p>参数二：查询的主键的取值 getRefrence() 参数同上</p>
</li>
</ul>
<p>区别：</p>
<p>使用find查询：（立即加载）<br>      1.查询的对象就是当前对象本身<br>      2.在调用find方法的时候，就会发送sql语句查询数据库<br>使用getReference查询：（延迟加载）<br>      1.获取的对象是一个动态代理对象<br>      2.调用getReference方法不会立即发送sql语句查询数据库当需要调用查询结果对象的时候，才会发送查询的sql语句。什么时候调用，什么时候发送 </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findCustomer</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//1.获取实体器工厂，获取实体器管理对象</span></span><br><span class="line">        EntityManager manager = JpaUtils.getEntityManager();</span><br><span class="line">        <span class="comment">//2.获取事务对象</span></span><br><span class="line">        EntityTransaction transaction = manager.getTransaction();</span><br><span class="line">        <span class="comment">//开启事务</span></span><br><span class="line">        transaction.begin();</span><br><span class="line">        <span class="comment">//3.执行查询</span></span><br><span class="line">        Customer customer = manager.find(Customer.class, <span class="number">1L</span>);<span class="comment">//记住添加L，id是Long类型的</span></span><br><span class="line">        <span class="comment">//Customer customer = manager.getReference(Customer.class, 1L);</span></span><br><span class="line">        System.out.println(customer);</span><br><span class="line">        <span class="comment">//4.提交事务</span></span><br><span class="line">        transaction.commit();</span><br><span class="line">        manager.close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>
<p>​    删除：</p>
<p>​    删除操作：注意：删除不是直接传入一个id去删除，而是传入一个对象去完成删除操作。remove(Object)</p>
<p>​    先find该用户，再执行查询。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteCustomer</span><span class="params">()</span></span>&#123;</span><br><span class="line">        EntityManager manager = JpaUtils.getEntityManager();</span><br><span class="line">        EntityTransaction transaction = manager.getTransaction();</span><br><span class="line">        transaction.begin();</span><br><span class="line">        Customer customer = manager.find(Customer.class, <span class="number">1L</span>);</span><br><span class="line">        manager.remove(customer);</span><br><span class="line">        transaction.commit();</span><br><span class="line">        manager.close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>
<p>更改：</p>
<p>先将对象查询出来，再调用merge(Object)方法。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateCustomer</span><span class="params">()</span></span>&#123;</span><br><span class="line">        EntityManager manager = JpaUtils.getEntityManager();</span><br><span class="line">        EntityTransaction transaction = manager.getTransaction();</span><br><span class="line">        transaction.begin();</span><br><span class="line">        Customer customer = manager.find(Customer.class, <span class="number">2L</span>);</span><br><span class="line">        customer.setCustPhone(<span class="string">"123456789"</span>);</span><br><span class="line">        manager.merge(customer);</span><br><span class="line">        transaction.commit();</span><br><span class="line">        manager.close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>
<h2 id="JPA中的复杂查询"><a href="#JPA中的复杂查询" class="headerlink" title="JPA中的复杂查询"></a>JPA中的复杂查询</h2><p>JPQL(Java Persistence Query Language).</p>
<p>SQL:查询的是数据库中的表和表的字段。</p>
<p>JPQL：查询的是实体类和类中的属性。</p>
<blockquote>
<p>基于首次在EJB2.0中引入的EJB查询语言(EJB QL),Java持久化查询语言(JPQL)是一种可移植的查询语言，旨在以面向对象表达式语言的表达式，将SQL语法和简单查询语义绑定在一起·使用这种语言编写的查询是可移植的，可以被编译成所有主流数据库服务器上的SQL。其特征与原生SQL语句类似，并且完全面向对象，通过类名和属性访问，而不是表名和表的属性。</p>
</blockquote>
<ol>
<li><p>查询所有用户</p>
<p>查询所有对象：SQL:select * from cst_customer</p>
<p>​                            JPQL:from ctgu.pojo.Customer   from Customer省略包路径也行</p>
<p>注意：JPQL中不能写select * （可以写select count(id)）</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findAllCustomer</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">//1.获取EntityManager对象</span></span><br><span class="line">       EntityManager manager = JpaUtils.getEntityManager();</span><br><span class="line">       <span class="comment">//2.开启事务</span></span><br><span class="line">       EntityTransaction transaction = manager.getTransaction();</span><br><span class="line">       transaction.begin();</span><br><span class="line">       <span class="comment">//3.查询全部</span></span><br><span class="line">       String jpql=<span class="string">"from Customer"</span>;</span><br><span class="line">       <span class="comment">//创建Query查询对象，query对象才是执行jpql的对象</span></span><br><span class="line">       Query query = manager.createQuery(jpql);</span><br><span class="line">       List list = query.getResultList();</span><br><span class="line">       <span class="keyword">for</span>(Object customer:list)&#123;</span><br><span class="line">           System.out.println(customer);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">//4.提交事务</span></span><br><span class="line">       transaction.commit();</span><br><span class="line">       <span class="comment">//5.释放资源</span></span><br><span class="line">       manager.close();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>排序查询</p>
<p>SQL:SELECT * FROM <code>cst_customer</code> ORDER BY cust_id DESC</p>
<p>JPQL:from Customer ORDER BY custId DESC</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OrderAllCustomer</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">//1.获取EntityManager对象</span></span><br><span class="line">       EntityManager manager = JpaUtils.getEntityManager();</span><br><span class="line">       <span class="comment">//2.开启事务</span></span><br><span class="line">       EntityTransaction transaction = manager.getTransaction();</span><br><span class="line">       transaction.begin();</span><br><span class="line">       <span class="comment">//3.查询全部</span></span><br><span class="line">       String jpql=<span class="string">"from Customer ORDER BY custId DESC"</span>;</span><br><span class="line">       <span class="comment">//创建Query查询对象，query对象才是执行jpql的对象</span></span><br><span class="line">       Query query = manager.createQuery(jpql);</span><br><span class="line">       List list = query.getResultList();</span><br><span class="line">       <span class="keyword">for</span>(Object customer:list)&#123;</span><br><span class="line">           System.out.println(customer);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">//4.提交事务</span></span><br><span class="line">       transaction.commit();</span><br><span class="line">       <span class="comment">//5.释放资源</span></span><br><span class="line">       manager.close();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>统计查询总数</p>
<p>SQL:SELECT COUNT(cust_id) FROM <code>cst_customer</code></p>
<p>JPQL:select count(custId) from Customer</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">countCustomer</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">//1.获取EntityManager对象</span></span><br><span class="line">       EntityManager manager = JpaUtils.getEntityManager();</span><br><span class="line">       <span class="comment">//2.开启事务</span></span><br><span class="line">       EntityTransaction transaction = manager.getTransaction();</span><br><span class="line">       transaction.begin();</span><br><span class="line">       <span class="comment">//3.查询全部</span></span><br><span class="line">       String jpql=<span class="string">"select count(custId) from Customer "</span>;</span><br><span class="line">       <span class="comment">//创建Query查询对象，query对象才是执行jpql的对象</span></span><br><span class="line">       Query query = manager.createQuery(jpql);</span><br><span class="line">       <span class="comment">/**</span></span><br><span class="line"><span class="comment">        *  由于返回的是单个值</span></span><br><span class="line"><span class="comment">        *   getSingleResult()得到唯一的结果</span></span><br><span class="line"><span class="comment">        *   getResultList()直接将查询的结果封装在list集合中</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">       Object result = query.getSingleResult();</span><br><span class="line">       System.out.println(<span class="string">"返回的用户总数为："</span>+result);</span><br><span class="line">       <span class="comment">//4.提交事务</span></span><br><span class="line">       transaction.commit();</span><br><span class="line">       <span class="comment">//5.释放资源</span></span><br><span class="line">       manager.close();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>分页查询</p>
<p>SQL:SELECT * FROM <code>cst_customer</code> LIMIT ?,?</p>
<p>JPQL:from Customer   再设置分页的参数</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PageCustomer</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">//1.获取EntityManager对象</span></span><br><span class="line">       EntityManager manager = JpaUtils.getEntityManager();</span><br><span class="line">       <span class="comment">//2.开启事务</span></span><br><span class="line">       EntityTransaction transaction = manager.getTransaction();</span><br><span class="line">       transaction.begin();</span><br><span class="line">       <span class="comment">//3.查询全部</span></span><br><span class="line">       String jpql=<span class="string">"from Customer "</span>;</span><br><span class="line">       <span class="comment">//创建Query查询对象，query对象才是执行jpql的对象</span></span><br><span class="line">       Query query = manager.createQuery(jpql);</span><br><span class="line">       <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * 设置分页参数</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">       query.setFirstResult(<span class="number">1</span>);</span><br><span class="line">       query.setMaxResults(<span class="number">3</span>);</span><br><span class="line">       List list = query.getResultList();</span><br><span class="line">       <span class="keyword">for</span> (Object customer:list) &#123;</span><br><span class="line">           System.out.println(customer);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">//4.提交事务</span></span><br><span class="line">       transaction.commit();</span><br><span class="line">       <span class="comment">//5.释放资源</span></span><br><span class="line">       manager.close();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>模糊查询</p>
<p>SQL:SELECT * FROM <code>cst_customer</code> where cust_name LIKE ‘%大学%’</p>
<p>JPQL:FORM Customer where custName like ?</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">chooseCustomer</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//1.获取EntityManager对象</span></span><br><span class="line">        EntityManager manager = JpaUtils.getEntityManager();</span><br><span class="line">        <span class="comment">//2.开启事务</span></span><br><span class="line">        EntityTransaction transaction = manager.getTransaction();</span><br><span class="line">        transaction.begin();</span><br><span class="line">        <span class="comment">//3.查询全部</span></span><br><span class="line">        String jpql=<span class="string">" from Customer where custName like ? "</span>;</span><br><span class="line">        <span class="comment">//创建Query查询对象，query对象才是执行jpql的对象</span></span><br><span class="line">        Query query = manager.createQuery(jpql);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 设置查询条件</span></span><br><span class="line"><span class="comment">         * 第一个参数：占位符的索引位置</span></span><br><span class="line"><span class="comment">         * 第二个参数：取值</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        query.setParameter(<span class="number">1</span>,<span class="string">"%大学%"</span>);</span><br><span class="line">        List list = query.getResultList();</span><br><span class="line">        <span class="keyword">for</span> (Object customer:list) &#123;</span><br><span class="line">            System.out.println(customer);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//4.提交事务</span></span><br><span class="line">        transaction.commit();</span><br><span class="line">        <span class="comment">//5.释放资源</span></span><br><span class="line">        manager.close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>
</li>
</ol>
<h3 id="maven坐标"><a href="#maven坐标" class="headerlink" title="maven坐标"></a>maven坐标</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang"></div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span><br><span class="line">&lt;project xmlns=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span><br><span class="line">         xmlns:xsi=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span><br><span class="line">         xsi:schemaLocation=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span><br><span class="line">    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span><br><span class="line"></span><br><span class="line">    &lt;groupId&gt;ctgu.rxz&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;jpa-01&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;</span><br><span class="line">    &lt;properties&gt;</span><br><span class="line">        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;</span><br><span class="line">        &lt;project.hibernate.version&gt;5.0.7.Final&lt;/project.hibernate.version&gt;</span><br><span class="line">    &lt;/properties&gt;</span><br><span class="line"></span><br><span class="line">    &lt;dependencies&gt;</span><br><span class="line">        &lt;!-- junit --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;junit&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;junit&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;4.12&lt;/version&gt;</span><br><span class="line">            &lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- hibernate对jpa的支持包 --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;hibernate-entitymanager&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;$&#123;project.hibernate.version&#125;&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- c3p0 --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;hibernate-c3p0&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;$&#123;project.hibernate.version&#125;&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- log日志 --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;log4j&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;log4j&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;1.2.17&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- Mysql and MariaDB --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;5.1.6&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure></div>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Rong</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://SlectRxz.github.io/2019/12/13/Spring Data JPA/SpringDataJPA_简介/">http://SlectRxz.github.io/2019/12/13/Spring Data JPA/SpringDataJPA_简介/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java框架/">Java框架    </a></div><div class="post_share"><div class="social-share" data-image="https://s2.ax1x.com/2019/12/20/QXe9PS.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> Donate<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2019/12/14/Spring Data JPA/SpringDataJPA_入门案例/"><img class="prev_cover lazyload" data-src="https://s2.ax1x.com/2019/12/20/QXe9PS.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">Previous Post</div><div class="prev_info"><span>Spring Data JPA入门案例</span></div></a></div><div class="next-post pull_right"><a href="/2019/11/04/java基础/基础知识的复习/"><img class="next_cover lazyload" data-src="https://s2.ax1x.com/2019/12/20/QXMOKg.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">Next Post</div><div class="next_info"><span>java基础知识复习</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> Recommend</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2019/12/15/Spring Data JPA/SpringDataJPA_底层实现原理/" title="Spring Data JPA底层实现原理"><img class="relatedPosts_cover lazyload"data-src="https://s2.ax1x.com/2019/12/20/QXe9PS.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-12-20</div><div class="relatedPosts_title">Spring Data JPA底层实现原理</div></div></a></div><div class="relatedPosts_item"><a href="/2019/12/14/Spring Data JPA/SpringDataJPA_入门案例/" title="Spring Data JPA入门案例"><img class="relatedPosts_cover lazyload"data-src="https://s2.ax1x.com/2019/12/20/QXe9PS.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-12-20</div><div class="relatedPosts_title">Spring Data JPA入门案例</div></div></a></div><div class="relatedPosts_item"><a href="/2019/12/20/taotao/主题测试/" title="这是一个测试页面"><img class="relatedPosts_cover lazyload"data-src="http://chuantu.xyz/t6/707/1576840539x1033347913.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-12-20</div><div class="relatedPosts_title">这是一个测试页面</div></div></a></div></div><div class="clear_both"></div></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 By Rong</div><div class="framework-info"><span>Driven </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div><div class="footer_custom_text">welcome to my blog~</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="Read Mode"></i><i class="fa fa-plus" id="font_plus" title="Increase font size"></i><i class="fa fa-minus" id="font_minus" title="Decrease font size"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="Traditional Chinese and Simplified Chinese Conversion" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="Dark Mode"></i></div><div id="rightside-config-show"><div id="rightside_config" title="Setting"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="Table of Contents" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="Back to top" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/fireworks.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/tw_cn.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>