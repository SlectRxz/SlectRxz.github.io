<!DOCTYPE html><html data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>Lucene就是这么简单-认识篇 | 荣先森</title><meta name="description" content="Lucene就是这么简单-认识篇"><meta name="keywords" content="javaWeb实战"><meta name="author" content="Rong"><meta name="copyright" content="Rong"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Lucene就是这么简单-认识篇"><meta name="twitter:description" content="Lucene就是这么简单-认识篇"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><meta property="og:type" content="article"><meta property="og:title" content="Lucene就是这么简单-认识篇"><meta property="og:url" content="http://SlectRxz.github.io/2019/08/04/taotao/Lucene-认识篇/"><meta property="og:site_name" content="荣先森"><meta property="og:description" content="Lucene就是这么简单-认识篇"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://SlectRxz.github.io/2019/08/04/taotao/Lucene-认识篇/"><link rel="prev" title="链表反转" href="http://SlectRxz.github.io/2019/08/11/代码总结/链表反转/"><link rel="next" title="后台添加商品" href="http://SlectRxz.github.io/2019/06/20/taotao/taotao商城之添加商品/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">荣先森</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">43</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">11</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">12</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">Catalog</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-什么是Lucene？？？"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">1.什么是Lucene？？？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-为什么需要使用Lucene？（数据库不好吗）"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">2.为什么需要使用Lucene？（数据库不好吗）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#3-索引库的组成（重要！！）"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">3.索引库的组成（重要！！）</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1）互联网搜索结构框图"><span class="toc_mobile_items-number">3.1.</span> <span class="toc_mobile_items-text">1）互联网搜索结构框图</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#4-第一个Lucene程序"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">4.第一个Lucene程序</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#4-1准备jar包"><span class="toc_mobile_items-number">4.0.1.</span> <span class="toc_mobile_items-text">4.1准备jar包</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#4-2准备一个pojo"><span class="toc_mobile_items-number">4.0.2.</span> <span class="toc_mobile_items-text">4.2准备一个pojo</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-3建立索引库并向索引库写内容"><span class="toc_mobile_items-number">4.1.</span> <span class="toc_mobile_items-text">4.3建立索引库并向索引库写内容</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-4向索引库中查找内容"><span class="toc_mobile_items-number">4.2.</span> <span class="toc_mobile_items-text">4.4向索引库中查找内容</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#5-封装重复代码"><span class="toc_mobile_items-number">5.</span> <span class="toc_mobile_items-text">5.封装重复代码</span></a></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-什么是Lucene？？？"><span class="toc-number">1.</span> <span class="toc-text">1.什么是Lucene？？？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-为什么需要使用Lucene？（数据库不好吗）"><span class="toc-number">2.</span> <span class="toc-text">2.为什么需要使用Lucene？（数据库不好吗）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-索引库的组成（重要！！）"><span class="toc-number">3.</span> <span class="toc-text">3.索引库的组成（重要！！）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1）互联网搜索结构框图"><span class="toc-number">3.1.</span> <span class="toc-text">1）互联网搜索结构框图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-第一个Lucene程序"><span class="toc-number">4.</span> <span class="toc-text">4.第一个Lucene程序</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1准备jar包"><span class="toc-number">4.0.1.</span> <span class="toc-text">4.1准备jar包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2准备一个pojo"><span class="toc-number">4.0.2.</span> <span class="toc-text">4.2准备一个pojo</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3建立索引库并向索引库写内容"><span class="toc-number">4.1.</span> <span class="toc-text">4.3建立索引库并向索引库写内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4向索引库中查找内容"><span class="toc-number">4.2.</span> <span class="toc-text">4.4向索引库中查找内容</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-封装重复代码"><span class="toc-number">5.</span> <span class="toc-text">5.封装重复代码</span></a></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png)"><div id="post-info"><div id="post-title"><div class="posttitle">Lucene就是这么简单-认识篇</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> Created 2019-08-04<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> Updated 2019-08-04</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/JavaWeb/">JavaWeb</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>Post View:</span><span id="busuanzi_value_page_pv"></span></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><p>Lucene的介绍和索引库的组成结构。<br><a id="more"></a></p>
<h2 id="1-什么是Lucene？？？"><a href="#1-什么是Lucene？？？" class="headerlink" title="1.什么是Lucene？？？"></a>1.什么是Lucene？？？</h2><blockquote>
<p>Lucene是apache软件基金会发布的一个开放源代码的全文检索引擎工具包，由资深全文检索专家Doug Cutting所撰写,它是一个全文检索引擎的架构，提供了完整的创建索引和查询索引，以及部分文本分析的引擎，Lucene的目的是为软件开发人员提供一个简单易用的工具包，以方便在目标系统中实现全文检索的功能，或者是以此为基础建立起完整的全文检索引擎，Lucene在全文检索领域是一个经典的祖先，现在很多检索引擎都是在其基础上创建的，思想是相通的。</p>
</blockquote>
<p>简单来说，Lucene是一个全文搜索引擎。</p>
<blockquote>
<p>全文检索是什么？</p>
</blockquote>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1)    从大量的信息中快速、准确地查找出要的信息<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2)    搜索的内容是文本信息(不是多媒体)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3)    搜索的方式：不是根据语句的意思进行处理。如果要搜索的文本为” 2012年的春晚有赵本山吗”，那么含有这些词(2012年、春晚、赵本山)就能搜索出来。每一个词都是关键词。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4)    全面、快速、准确是衡量全文检索系统的关键指标。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5)    概括：<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a)    只处理文本<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b)    不处理语义<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c)    搜索时英文不区分大小写<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d)    结果列表有相关度排序</p>
<h2 id="2-为什么需要使用Lucene？（数据库不好吗）"><a href="#2-为什么需要使用Lucene？（数据库不好吗）" class="headerlink" title="2.为什么需要使用Lucene？（数据库不好吗）"></a>2.为什么需要使用Lucene？（数据库不好吗）</h2><blockquote>
<p>全文检索与数据库搜索的区别：</p>
</blockquote>
<p><strong>1. 数据库的搜索</strong><br>类似：select <em> from  表名 where 字段名 like ‘%关键字%’<br>例如：select </em> from article where content like’%here%’<br>结果:  where   here  shere<br>缺点：<font color="red">（没有将搜索结果相关度排序）</font><br>1)搜索效果比较差<br>2)在搜索的结果中，有大量的数据被搜索出来，有很多数据是没有用的。<br>3)查询速度在大量数据的情况下是很难做到快速的。</p>
<p><strong>2. 全文检索：</strong><br>1)    搜索结果按相关度排序：意味着只有前几个页面对于用户来说是比较有用的，其他的结果与用户想要的答案很可能相差甚远。数据库搜索是做不到相关度排序的。<br>2)    因为全文检索是采用引索的方式，所以在速度上肯定比数据库方式like要快。</p>
<h2 id="3-索引库的组成（重要！！）"><a href="#3-索引库的组成（重要！！）" class="headerlink" title="3.索引库的组成（重要！！）"></a>3.索引库的组成（重要！！）</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>在讲解如何具体的使用Lucene进行检索之前，我们首先得弄明白Lucene存放的究竟是啥？在数据库中，我们是将数据作为表为基本单位进行存储，那么Lucene又是如何进行存储的呢？</p>
<p>Lucene中存的就是一系列的<font color="red">二进制压缩文件和一些控制文件</font>，它们位于计算机的硬盘上，<br>这些内容统称为<font color="red">索引库</font>，索引库有二部份组成：<br>（1）目录</p>
<ul>
<li>按照一定的拆分策略（即分词器）将原始记录中的每个字符拆开后，存入一个供将来搜索的表<br>（2）内容</li>
<li>存入到索引库中的原始文本，例如：Java是世界上最好的语言</li>
</ul>
<p>也就是说：Lucene存放数据的地方我们通常称之为索引库，索引库又分为两部分组成：<strong>目录</strong>和<strong>内容</strong>。</p>
<p><strong>理解：</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>把索引库当作一本书，那么当我们要去查询某一节内容时，需要根据关键句找到对应的页数，再根据页数找到对应的内容。<br>只需记住<font color="red">Lucene是向索引库中进行操作，索引库由目录和内容组成。</font><br>下面将具体介绍目录和内容的组成：</p>
<h3 id="1）互联网搜索结构框图"><a href="#1）互联网搜索结构框图" class="headerlink" title="1）互联网搜索结构框图"></a>1）互联网搜索结构框图</h3><p><br></p>
<center><a href="/img/imgs/taotao/Lucene/1.png" data-fancybox="group" data-caption="互联网搜索流程图" class="fancybox"><img src="/img/imgs/taotao/Lucene/1.png" alt="互联网搜索流程图" title="互联网搜索流程图"></a></center>

<p><strong>说明：</strong><br>1)    当用户打开&nbsp;<a href="http://www.baidu.com&nbsp;网页搜索某些数据的时候，不是直接找的网页，而是找的百度的索引库。索引库里包含的内容有索引号和摘要。当我们打开&nbsp;www.baidu.com&nbsp;时，看到的就是摘要的内容。" target="_blank" rel="noopener">www.baidu.com&nbsp;网页搜索某些数据的时候，不是直接找的网页，而是找的百度的索引库。索引库里包含的内容有索引号和摘要。当我们打开&nbsp;www.baidu.com&nbsp;时，看到的就是摘要的内容。</a><br>2)    百度的索引库的索引和互联网的某一个网站对应。<br>3)    当用户数据要查询的关键字，返回的页面首先是从索引库中得到的。<br>4)    点击每一个搜索出来的内容进行相关网页查找，这个时候才找的是互联网中的网页。</p>
<blockquote>
<p>Lucene的索引库的结构之后，在数据库中数据是以表为基本单位进行存储的，在索引库中需要存放各种不同类型的数据，是以什么方式存储呢？</p>
</blockquote>
<p><br></p>
<center><a href="/img/imgs/taotao/Lucene/3.png" data-fancybox="group" data-caption="Lucene的结构框图" class="fancybox"><img src="/img/imgs/taotao/Lucene/3.png" alt="Lucene的结构框图" title="Lucene的结构框图"></a></center><br><center>Lucene的结构框图</center>

<p>1)    在数据库中，数据库中的数据文件存储在磁盘上。索引库也是同样，索引库中的索引数据也在磁盘上存在，我们用Directory这个类来描述。<br>2)    我们可以通过API来实现对索引库的增、删、改、查的操作。<br>3)    在数据库中，各种数据形式都可以概括为一种：表。在索引库中，各种数据形式也可以抽象出一种数据格式为Document。（类比数据库中的表结构）<br>4)    Document的结构为：Document(List&#60;Field&#62;)<br>5)    Field里存放一个键值对。键值对都为字符串的形式。<br>6)    对索引库中索引的操作实际上也就是对Document的操作。</p>
<h2 id="4-第一个Lucene程序"><a href="#4-第一个Lucene程序" class="headerlink" title="4.第一个Lucene程序"></a>4.第一个Lucene程序</h2><h4 id="4-1准备jar包"><a href="#4-1准备jar包" class="headerlink" title="4.1准备jar包"></a>4.1准备jar包</h4><p>搭建lucene的开发环境，要准备lucene的jar包，要加入的jar包至少有：<br>1)    lucene-core-3.1.0.jar     (核心包)<br>2)    lucene-analyzers-3.1.0.jar    (分词器)<br>3)    lucene-highlighter-3.1.0.jar    (高亮器)<br>4)    lucene-memory-3.1.0.jar       (高亮器)</p>
<h4 id="4-2准备一个pojo"><a href="#4-2准备一个pojo" class="headerlink" title="4.2准备一个pojo"></a>4.2准备一个pojo</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">package com.pojo;</span><br><span class="line">public class article &#123;</span><br><span class="line">	private Long id;</span><br><span class="line">	private String name;</span><br><span class="line">	private String content;</span><br><span class="line">	public Long getId() &#123;</span><br><span class="line">		return id;</span><br><span class="line">	&#125;</span><br><span class="line">	public void setId(Long id) &#123;</span><br><span class="line">		this.id = id;</span><br><span class="line">	&#125;</span><br><span class="line">	public String getName() &#123;</span><br><span class="line">		return name;</span><br><span class="line">	&#125;</span><br><span class="line">	public void setName(String name) &#123;</span><br><span class="line">		this.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	public String getContent() &#123;</span><br><span class="line">		return content;</span><br><span class="line">	&#125;</span><br><span class="line">	public void setContent(String content) &#123;</span><br><span class="line">		this.content = content;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h3 id="4-3建立索引库并向索引库写内容"><a href="#4-3建立索引库并向索引库写内容" class="headerlink" title="4.3建立索引库并向索引库写内容"></a>4.3建立索引库并向索引库写内容</h3><p><br></p>
<center><a href="/img/imgs/taotao/Lucene/addDirectory.png" data-fancybox="group" data-caption="建立索引" class="fancybox"><img src="/img/imgs/taotao/Lucene/addDirectory.png" alt="建立索引" title="建立索引"></a></center><br><center>向索引库中添加索引</center>

<p><strong>分析：</strong><br>写入索引库使用的类：indexWriter<br>创建IndexWriter构造函数需要三个参数：索引库，分词器，存储的最大长度</p>
<p>//索引库  需要指定索引库的位置<br>Directory directory = FSDirectory.open(new File(“./indexDir”));//存在当前路径下的indexDir文件下<br>//分词器   需要指定一个分词器版本<br>Analyzer analyzer = new StandardAnalyzer(Version.LUCENE_30);</p>
<p>得到了indexWriter对象——-&gt;indexWriter需要向索引库写的是什么呢？——–&gt;写的是document对象——–&gt;ducument对象里面存储的是什么？———-&gt;filed对象<br>filed对象有四个参数：<br>1）放在索引库中的name名称<br>2）放在索引库中的value<br>3）是否存储在索引库中（针对内容库）<br>4）是否添加在目录中（针对目录库）</p>
<p>代码：<br><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line">	 * 1、创建一个article对象</span><br><span class="line">	 * 2、把article对象转化成document对象</span><br><span class="line">	 * 3、创建一个IndexWriter对象</span><br><span class="line">	 * 4、把document对象加入到索引库中</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void createIndex() throws Exception&#123;</span><br><span class="line">		//1.创建IndexWriter对象,参数需要：索引库，分分词器，存储的最大长度</span><br><span class="line">		//索引库</span><br><span class="line">		Directory directory = FSDirectory.open(new File(&quot;./indexDir&quot;));</span><br><span class="line">		//分词器</span><br><span class="line">		Analyzer analyzer=new StandardAnalyzer(Version.LUCENE_30);</span><br><span class="line">		/**</span><br><span class="line">		 * directory指向了索引库的路径  &quot;./indexDir&quot;</span><br><span class="line">		 * analyzer 分词器  把title,content的内容分词后的内容放入到目录中</span><br><span class="line">		 * MaxFieldLength 限制每一个字段往索引库中存放的大小</span><br><span class="line">		 */</span><br><span class="line">		IndexWriter indexWriter = new IndexWriter(directory, analyzer, MaxFieldLength.LIMITED);</span><br><span class="line">		//2.准备需要存储的内容</span><br><span class="line">		article article = new article();</span><br><span class="line">		article.setId(1L);</span><br><span class="line">		article.setName(&quot;lucene可以做搜索引擎&quot;);</span><br><span class="line">		article.setContent(&quot;baidu,google可以快速查询用户所需的内容&quot;);</span><br><span class="line">		//3.准备document对象</span><br><span class="line">		Document document = new Document();</span><br><span class="line">		//4.添加内容</span><br><span class="line">		/**</span><br><span class="line">		 * 第一个参数</span><br><span class="line">		 *    放入到索引库中的name的名称&quot;id&quot;</span><br><span class="line">		 * 第二个参数</span><br><span class="line">		 *    放入到索引库中的value：id的值</span><br><span class="line">		 * 第三个参数</span><br><span class="line">		 *    Store</span><br><span class="line">		 *       YES  该字段向内容库中存储</span><br><span class="line">		 *       no   该字段不向内容库中存储</span><br><span class="line">		 * 第四个字段</span><br><span class="line">		 *    Index</span><br><span class="line">		 *       no   不向目录库中存储</span><br><span class="line">		 *       NOT_ANALYZED  存储，但是不分词</span><br><span class="line">		 *       ANALYZED      存储，分词</span><br><span class="line">		 */</span><br><span class="line">		document.add(new Field(&quot;id&quot;, article.getId().toString(), Store.YES, Index.ANALYZED));</span><br><span class="line">		document.add(new Field(&quot;title&quot;, article.getName(), Store.YES, Index.ANALYZED));</span><br><span class="line">		document.add(new Field(&quot;content&quot;, article.getContent().toString(), Store.YES, Index.ANALYZED));</span><br><span class="line">		//indexwriter调用写方法写</span><br><span class="line">		indexWriter.optimize();</span><br><span class="line">		indexWriter.addDocument(document);</span><br><span class="line">		indexWriter.close();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure></div></p>
<center><a href="/img/imgs/taotao/Lucene/writeInDirecrory.png" data-fancybox="group" data-caption="添加内容" class="fancybox"><img src="/img/imgs/taotao/Lucene/writeInDirecrory.png" alt="添加内容" title="添加内容"></a></center><br><center>向索引库中添加内容</center>

<h3 id="4-4向索引库中查找内容"><a href="#4-4向索引库中查找内容" class="headerlink" title="4.4向索引库中查找内容"></a>4.4向索引库中查找内容</h3><p><strong>分析：</strong></p>
<ol>
<li>查找数据需要IndexSearch类<br>1）<strong>类的初始化</strong><br>IndexSearcher indexSearcher = new IndexSearcher(directory);<br>创建参数需要传入一个索引库（你得告诉别人从哪个库找）<br>2）<strong>查找的方法</strong><br>TopDocs topDocs = indexSearch.search(Query,N),返回一个TopDocs<br><strong>形参的代表的意思：</strong><br><font color="red">Query对象：</font><br>QueryParser queryParser = new QueryParser(Version.LUCENE_30, “title”, analyzer);<br>Query query = queryParser.parse(“lucene”);             <ul>
<li>参数一：需要一个版本号</li>
<li>参数二：表示在那个字段进行检索，字段就是上述filed对象的key值</li>
<li>参数三：分词器，因为还需要对输入的查询信息进行分词<br>queryParser.parse(“lucene”);    表示对那些内容进行查找<br>N:表示查找n条记录<br><strong>返回值TopDocs:</strong></li>
</ul>
</li>
</ol>
<blockquote>
<p>可以把TopDocs这样理解，它就是根据关键词检索出来的  目录记录，后面根据这个目录记录去找对应的内容库中的document（关于目录库和内容库看图）<br>int count = topDocs.totalHits;  // 根据关键词计算出来的总的记录数</p>
</blockquote>
<p>现在如何从TopDocs获取到我们想要的内容呢？<br>搜索的过程为：<br>先根据内容在目录库内找到索引值，再根据索引值到内容库里面找，找到对应的document<br>如何获取document呢？<br>ScoreDoc[] scoreDocs = topDocs.scoreDocs;<br>Document document = indexSearcher.doc(scoreDoc.doc);<br>scoreDoc.doc  根据关键词找到的索引<br>得到的就是索引库目录中的索引值，根据这个值去内容库中找内容</p>
<p><center><a href="/img/imgs/taotao/Lucene/searchInDirectory.png" data-fancybox="group" data-caption="搜索内容" class="fancybox"><img src="/img/imgs/taotao/Lucene/searchInDirectory.png" alt="搜索内容" title="搜索内容"></a></center></p>
<p><center>向索引库中搜索内容</center><br>代码：<br><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@Test</span><br><span class="line">	public void searchIndex() throws Exception&#123;</span><br><span class="line">		//1.创建一个IndexSearch对象   需要一个索引库</span><br><span class="line">		//索引库</span><br><span class="line">		Directory directory = FSDirectory.open(new File(&quot;./indexDir&quot;));</span><br><span class="line">		IndexSearcher indexSearcher = new IndexSearcher(directory);</span><br><span class="line">		//2.创建一个Query对象   首先需要创建一个QueryParse对象</span><br><span class="line">		//分词器</span><br><span class="line">		Analyzer analyzer = new StandardAnalyzer(Version.LUCENE_30);</span><br><span class="line">		QueryParser queryParser = new QueryParser(Version.LUCENE_30, &quot;title&quot;, analyzer);</span><br><span class="line">		/*</span><br><span class="line">		 * 第一个参数</span><br><span class="line">		 *     版本号</span><br><span class="line">		 * 第二个参数</span><br><span class="line">		 *     在哪个字段中进行检索    字段对应前面filed的key有几个</span><br><span class="line">		 * 第三个参数</span><br><span class="line">		 *     为分词器，在调用queryParser的parse方法的时候，需要对查询参数再次进行分词</span><br><span class="line">		 */</span><br><span class="line">		Query query = queryParser.parse(&quot;lucene&quot;);</span><br><span class="line"></span><br><span class="line">		//3.执行搜索</span><br><span class="line">		TopDocs topDocs = indexSearcher.search(query, 2);</span><br><span class="line">		/*</span><br><span class="line">		*可以把TopDocs这样理解，它就是根据关键词检索出来的  目录记录，后面根据这个目录记录去找对应的内容库中的document</span><br><span class="line">		*/</span><br><span class="line">		int count = topDocs.totalHits;  // 根据关键词计算出来的总的记录数</span><br><span class="line">		/**</span><br><span class="line">		 * query参数</span><br><span class="line">		 *     包含了一个分词器</span><br><span class="line">		 *     包含了一个关键词</span><br><span class="line">		 * n 查找前n条记录</span><br><span class="line">		 * TopDocs==Top Documents  前一些Documents</span><br><span class="line">		 */</span><br><span class="line">		//4.得到document对象</span><br><span class="line">		ScoreDoc[] scoreDocs = topDocs.scoreDocs;</span><br><span class="line"></span><br><span class="line">		ArrayList&lt;article&gt; articles = new ArrayList&lt;article&gt;();</span><br><span class="line">		for (ScoreDoc scoreDoc : scoreDocs) &#123;</span><br><span class="line">			//Document document = new Document();</span><br><span class="line">			int doc = scoreDoc.doc;</span><br><span class="line">			//scoreDoc.doc  根据关键词找到的索引     得到的就是索引库目录中的索引值，根据这个值去内容库中找内容</span><br><span class="line">			Document document = indexSearcher.doc(doc);</span><br><span class="line">			article article = new article();</span><br><span class="line">			//Document转化成article的过程</span><br><span class="line">			article.setId(Long.parseLong(document.get(&quot;id&quot;)));</span><br><span class="line">			article.setName(document.get(&quot;title&quot;));</span><br><span class="line">			article.setContent(document.get(&quot;content&quot;));</span><br><span class="line">			articles.add(article);</span><br><span class="line">		&#125;</span><br><span class="line">		for (article aa : articles) &#123;</span><br><span class="line">			System.out.println(aa.getId());</span><br><span class="line">			System.out.println(aa.getName());</span><br><span class="line">			System.out.println(aa.getContent());</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure></div></p>
<p>总结步骤：<br>1)    <strong>创建IndexSearch</strong><br>IndexSearcher indexSearcher = new IndexSearcher(directory);<br>//索引库<br>Directory directory = FSDirectory.open(new File(“./indexDir”));<br>//分词器<br>Analyzer analyzer = new StandardAnalyzer(Version.LUCENE_30);<br>2)    <strong>创建Query对象</strong><br>QueryParser queryParser = new QueryParser(Version.LUCENE_30, “title”, analyzer);</p>
<pre><code>     第一个参数
         版本号
     第二个参数
         在哪个字段中进行检索    字段对应前面filed的key有几个
     第三个参数
         为分词器，在调用queryParser的parse方法的时候，需要对查询参数再次进行分词

Query query = queryParser.parse(&quot;lucene&quot;);
</code></pre><p>3)    <strong>进行搜索</strong><br>TopDocs topDocs = indexSearcher.search(query, 2);<strong>2表示返回的记录条数</strong><br>4)    获得总结果数和前N行记录ID列表<br>int count = topDocs.totalHits;  // 根据关键词计算出来的总的记录数<br>5)    根据目录ID列表把Document转为为pojo并放入集合中。<br>ScoreDoc[] scoreDocs = topDocs.scoreDocs;<br>int doc = scoreDocs[i].doc;<br>Document document = indexSearcher.doc(doc);<br><strong>说明：</strong><br>这个时候 indexSearcher.doc(doc)根据关键词找到的索引     得到的就是索引库目录中的索引值，根据这个值去内容库中找内容<br>6)    循环出要检索的内容<br>document.get(“id”)<br>document.get(“title”)<br>document.get(“content”)</p>
<h2 id="5-封装重复代码"><a href="#5-封装重复代码" class="headerlink" title="5.封装重复代码"></a>5.封装重复代码</h2><blockquote>
<p>上述操作其实有许多重复代码，如索引库的创建，分析器的创建，pojo与Document对象之间的转换等都可以提取出公共的代码块，提取工具类。</p>
</blockquote>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Rong</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://SlectRxz.github.io/2019/08/04/taotao/Lucene-认识篇/">http://SlectRxz.github.io/2019/08/04/taotao/Lucene-认识篇/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/javaWeb实战/">javaWeb实战    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> Donate<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2019/08/11/代码总结/链表反转/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">Previous Post</div><div class="prev_info"><span>链表反转</span></div></a></div><div class="next-post pull_right"><a href="/2019/06/20/taotao/taotao商城之添加商品/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">Next Post</div><div class="next_info"><span>后台添加商品</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> Recommend</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2019/06/03/taotao/Dubbo架构的使用/" title="SPring整合Dubbo+zookeeper"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-12-20</div><div class="relatedPosts_title">SPring整合Dubbo+zookeeper</div></div></a></div><div class="relatedPosts_item"><a href="/2019/06/17/taotao/FastDFS的配置/" title="FastDFS介绍"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-12-20</div><div class="relatedPosts_title">FastDFS介绍</div></div></a></div><div class="relatedPosts_item"><a href="/2019/06/20/taotao/taotao商城之添加商品/" title="后台添加商品"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-12-20</div><div class="relatedPosts_title">后台添加商品</div></div></a></div><div class="relatedPosts_item"><a href="/2019/06/18/taotao/taotao商城之后台商品列表查询/" title="后台商品列表查询"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-12-20</div><div class="relatedPosts_title">后台商品列表查询</div></div></a></div><div class="relatedPosts_item"><a href="/2019/06/01/taotao/项目的建立/" title="聚合工程项目建立"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-12-20</div><div class="relatedPosts_title">聚合工程项目建立</div></div></a></div><div class="relatedPosts_item"><a href="/2019/08/11/代码总结/用户自动登录/" title="链表反转"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-12-20</div><div class="relatedPosts_title">链表反转</div></div></a></div></div><div class="clear_both"></div></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 By Rong</div><div class="framework-info"><span>Driven </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="Read Mode"></i><i class="fa fa-plus" id="font_plus" title="Increase font size"></i><i class="fa fa-minus" id="font_minus" title="Decrease font size"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="Traditional Chinese and Simplified Chinese Conversion" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="Dark Mode"></i></div><div id="rightside-config-show"><div id="rightside_config" title="Setting"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="Table of Contents" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="Back to top" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="/js/tw_cn.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>